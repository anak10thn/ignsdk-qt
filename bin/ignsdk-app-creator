#!/bin/bash
#  Ibnu Yahya <ibnu.yahya@toroo.org>

DESTDIR="$HOME/IGNSDK-APP/"
DEST=false
HELP=false
DIST=`cat /etc/ignsdk-dist`

if [ ! -d $DESTDIR ];then
	mkdir $DESTDIR
fi

TEMP=`getopt -o vdm: --long name:,help \
             -n 'ignsdk-app-creator' -- "$@"`

if [ $? != 0 ] ; then 
cat <<EOF
Usage: ignsdk-app-creator --name=[PROJECT NAME]

Example: ignsdk-app-creator --name=new-project

[PROJECT NAME] :
	example : new-project
EOF
echo "Terminating..." >&2 ; exit 1 ; fi

help ()
{

cat <<EOF
Usage: ignsdk-app-creator --name=[PROJECT NAME]

Example: ignsdk-app-creator --name=new-project

[PROJECT NAME] :
	example : new-project
EOF
	
exit 0
}

create_project ()
{
	/usr/share/ignsdk/bin/ignsdk-$DIST-creator 
}

eval set -- "$TEMP"

while true; do
  case "$1" in
    --name ) if [ $2 == "" ];then
		DEST=false
	 else
		if [ ! -d "$DESTDIR$2.ign" ];then
			DEST=true
			BUILDDEST="$DESTDIR$2.ign"
			PKGNAME="$2.ign"
			mkdir "$DESTDIR$2.ign"
		else
			echo "Project exist!!"
			help
		fi
	 fi
    shift 2 ;;
    --help ) HELP=true; shift ;;
    -- ) shift; break ;;
    * ) break ;;
  esac
done

if [ $HELP == true ]
then
help
fi

if [ $DEST == true ]
then
create_project $PKGNAME $BUILDDEST
else
echo "ERROR: name project"
help
fi
